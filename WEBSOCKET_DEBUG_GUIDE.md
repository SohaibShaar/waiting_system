# ุฏููู ุชุชุจุน ูุดููุฉ WebSocket

## ุงููุดููุฉ
ุนูุฏ ุงุณุชุฏุนุงุก ูุฑูุถุ ูุง ูุธูุฑ ุนูู ุดุงุดุฉ ุงูุนุฑุถ ููุฑุงู.

## ุฎุทูุงุช ุงูุชุดุฎูุต

### 1. ุงูุชุญ Console ูู Backend (Terminal ุญูุซ ูุนูู `npm run dev`)

ุนูุฏ ุงุณุชุฏุนุงุก ูุฑูุถุ ูุฌุจ ุฃู ุชุฑู:

```
โ ูุชูุฌุฉ callNextPatient: { success: true, queueNumber: 1, displayNumber: 2 }
๐ก ุฅุฑุณุงู emitPatientCalled ูู callNext...
๐ก ุฅุฑุณุงู patient-called ุฅูู X ุนููู ูู display-screen
๐ก ุชู ุฅุฑุณุงู patient-called: { queueNumber: 1, displayNumber: 2, ... }
โ ุชู ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ูู callNext
```

**ุฅุฐุง ุฑุฃูุช:**
- โ `ุนุฏุฏ ุงููุดุชุฑููู ูู display-screen: 0` โ ุงููุดููุฉ: ุดุงุดุฉ ุงูุนุฑุถ ุบูุฑ ูุดุชุฑูุฉ!
- โ `displayNumber ุฃู queueNumber ููููุฏ!` โ ุงููุดููุฉ ูู patient.service.ts

---

### 2. ุงูุชุญ Console ูู Frontend (ุดุงุดุฉ ุงูุนุฑุถ - F12)

ุนูุฏ ูุชุญ ุดุงุดุฉ ุงูุนุฑุถุ ูุฌุจ ุฃู ุชุฑู:

```
๐ ุฅูุดุงุก ุงุชุตุงู WebSocket ุฌุฏูุฏ...
โ ูุชุตู ุจุงูุฎุงุฏู - Socket ID: xyz123
๐บ ุชู ุงูุงุดุชุฑุงู ูู ุดุงุดุฉ ุงูุนุฑุถ
```

ุนูุฏ ุงุณุชุฏุนุงุก ูุฑูุถุ ูุฌุจ ุฃู ุชุฑู:

```
๐ข ุงุณุชูุจุงู ุงุณุชุฏุนุงุก ุฌุฏูุฏ: { queueNumber: 1, displayNumber: 2, ... }
โ ุชูุช ุฅุถุงูุฉ ุงูุฏูุฑ #1 ุฅูู ุงูุทุงุจูุฑ
๐ ุนุฏุฏ ุงูุฃุฏูุงุฑ ูู ุงูุทุงุจูุฑ: 1
๐ ูุนุงูุฌุฉ ุงูุฏูุฑ #1
๐ ุชุดุบูู ุงูุตูุช ููุฏูุฑ #1
โ ุงูุชูู ุงูุตูุช ููุฏูุฑ #1
```

**ุฅุฐุง ูู ุชุฑู `๐ข ุงุณุชูุจุงู ุงุณุชุฏุนุงุก ุฌุฏูุฏ:`** โ ุงููุดููุฉ ูู ุงูุงุชุตุงู!

---

### 3. ูุญุต ุงูุงุชุตุงู

#### ูู Backend Console:
ุนูุฏ ูุชุญ ุดุงุดุฉ ุงูุนุฑุถ:
```
โ ุนููู ุฌุฏูุฏ ูุชุตู - Socket ID: xyz123
๐บ ุงูุนููู xyz123 ุงุดุชุฑู ูู ุดุงุดุฉ ุงูุนุฑุถ
๐ ุนุฏุฏ ุงููุดุชุฑููู ูู display-screen: 1
```

**ุฅุฐุง ูู ุชุฑู ูุฐู ุงูุฑุณุงุฆู:**
1. ุชุฃูุฏ ุฃู ุงูุณูุฑูุฑ ูุนูู ุนูู `http://localhost:3003`
2. ุชุฃูุฏ ุฃู ุดุงุดุฉ ุงูุนุฑุถ ูุชุตูุฉ ุจููุณ ุงูุนููุงู

---

## ุงูุญููู ุงูุณุฑูุนุฉ

### ุงูุญู 1: ุฅุนุงุฏุฉ ุชุดุบูู ูู ุดูุก

```bash
# ุฃููู Backend (Ctrl+C)
# ุฃููู Frontend (Ctrl+C)

# ุดุบู Backend ูู ุฌุฏูุฏ
npm run dev

# ูู terminal ุขุฎุฑุ ุดุบู Frontend
cd web
npm run dev
```

### ุงูุญู 2: ุชูุธูู Cache

```bash
# Frontend
cd web
rm -rf node_modules/.vite
npm run dev
```

### ุงูุญู 3: ุงูุชุญูู ูู Port

ุชุฃูุฏ ุฃู Backend ูุนูู ุนูู port 3003:
```bash
# ูู Backend console ูุฌุจ ุฃู ุชุฑู:
๐ Server is running on http://localhost:3003
```

---

## ุชูุงุตูู ุงูุชุนุฏููุงุช ุงูุฃุฎูุฑุฉ

### 1. `src/controllers/station.controller.ts`
ุฃุถููุง console.log ูุชุชุจุน:
- ูุชูุฌุฉ `callNextPatient`
- ูุชูุฌุฉ `callSpecificQueue`
- ุฅุฑุณุงู `emitPatientCalled`

### 2. `src/websocket/socket.ts`
ุฃุถููุง:
- ุนุฑุถ ุนุฏุฏ ุงูุนููุงุก ุงููุดุชุฑููู ูู `display-screen`
- ุชูุงุตูู ุงูุจูุงูุงุช ุงูููุฑุณูุฉ

### 3. `src/index.ts`
ุฃุถููุง:
- ุชุชุจุน ุงุชุตุงู ุงูุนููุงุก
- ุนุฑุถ ุนุฏุฏ ุงููุดุชุฑููู ูู ูู room

### 4. `web/src/pages/DisplayScreen.tsx`
- โ ุฅุตูุงุญ dependency array โ `[]` ุจุฏูุงู ูู `[getStationName, audioEnabled]`
- โ ุฅุถุงูุฉ console.log ููุตููุฉ
- โ ุชุญุณูู ููุทู ุงูุงุดุชุฑุงู

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุดุบู Backend ูFrontend**
2. **ุงูุชุญ ุดุงุดุฉ ุงูุนุฑุถ ูุฑุงูุจ Console**
3. **ุงูุชุญ ุตูุญุฉ ูุญุทุฉ**
4. **ุงุณุชุฏุนู ูุฑูุถุงู**
5. **ุฑุงูุจ Console ูู Backend ู Frontend**
6. **ุฃุฑุณู ูู ูุง ุชุฑุงู ูู Console**

---

## ุฃุณุฆูุฉ ููุชุดุฎูุต

ุนูุฏูุง ุชุณุชุฏุนู ูุฑูุถุงู:

1. ูู ุชุฑู ูู **Backend Console**: `๐ก ุฅุฑุณุงู emitPatientCalled...`?
2. ูู ุชุฑู ูู **Backend Console**: `ุนุฏุฏ ุงููุดุชุฑููู ูู display-screen: 1` (ุฃู ุฃูุซุฑ)?
3. ูู ุชุฑู ูู **Frontend Console** (ุดุงุดุฉ ุงูุนุฑุถ): `๐ข ุงุณุชูุจุงู ุงุณุชุฏุนุงุก ุฌุฏูุฏ`?
4. ูู ุดุงุดุฉ ุงูุนุฑุถ ููุชูุญุฉ ูุจู ุงูุงุณุชุฏุนุงุกุ

ุฃุฑุณู ูู ุงูุฅุฌุงุจุงุช ูุณูุญู ุงููุดููุฉ! ๐

