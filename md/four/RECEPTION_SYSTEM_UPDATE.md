# ุชุญุฏูุซ ูุธุงู ุงูุงุณุชูุจุงู - ุงูุญููู ูุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุชุญุฏูุซ ูุธุงู ุงูุงุณุชูุจุงู ูุฏุนู ุญุงูุงุช ูุฎุชููุฉ ููุฒูุฌูู ูุฅุถุงูุฉ ุญููู ุฌุฏูุฏุฉ:

### ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ (SpouseStatus)
1. **ุนุงุฏู (NORMAL)**: ุงูุฒูุฌ/ุงูุฒูุฌุฉ ููุฌูุฏ - ุฌููุน ุงูุจูุงูุงุช ูุทููุจุฉ
2. **ุฏุนูุฉ ุดุฑุนูุฉ (LEGAL_INVITATION)**: ุดุฎุต ูุงุญุฏ ููุท ูุฃุชู ูููุฑุงุฌุนุฉ
3. **ุฎุงุฑุฌ ุงููุทุฑ (OUT_OF_COUNTRY)**: ุงูุฒูุฌ/ุงูุฒูุฌุฉ ุฎุงุฑุฌ ุงููุทุฑ - ุงูุจูุงูุงุช ุงุฎุชูุงุฑูุฉ
4. **ุฎุงุฑุฌ ุงููุญุงูุธุฉ (OUT_OF_PROVINCE)**: ุงูุฒูุฌ/ุงูุฒูุฌุฉ ุฎุงุฑุฌ ุงููุญุงูุธุฉ - ุงูุจูุงูุงุช ุงุฎุชูุงุฑูุฉ

### ุงูุญููู ุงูุฌุฏูุฏุฉ
ุชูุช ุฅุถุงูุฉ 3 ุญููู ุฌุฏูุฏุฉ ููู ูู ุงูุฒูุฌ ูุงูุฒูุฌุฉ:
- **ููุงู ุงูููุงุฏุฉ** (BirthPlace)
- **ุงูููุฏ** (Registration)
- **ุงูุจูุฏ** (Country)

---

## ๐๏ธ ุงูุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ุฅุถุงูุฉ Enum ุฌุฏูุฏ
```prisma
enum SpouseStatus {
  NORMAL           // ุนุงุฏู - ุงูุฒูุฌุงู ููุฌูุฏุงู
  LEGAL_INVITATION // ุฏุนูุฉ ุดุฑุนูุฉ - ุดุฎุต ูุงุญุฏ ููุท
  OUT_OF_COUNTRY   // ุฎุงุฑุฌ ุงููุทุฑ
  OUT_OF_PROVINCE  // ุฎุงุฑุฌ ุงููุญุงูุธุฉ
}
```

### 2. ุชุญุฏูุซ ุฌุฏูู ReceptionData
```prisma
model ReceptionData {
  // ุญุงูุฉ ุงูุฒูุฌูู
  maleStatus       SpouseStatus @default(NORMAL)
  femaleStatus     SpouseStatus @default(NORMAL)
  
  // ุจูุงูุงุช ุงูุฒูุฌ (ุฃุตุจุญุช ุงุฎุชูุงุฑูุฉ)
  maleName         String?      @db.VarChar(255)
  maleLastName     String?      @db.VarChar(255)
  maleFatherName   String?      @db.VarChar(255)
  maleBirthDate    DateTime?    @db.DateTime
  maleNationalId   String?      @db.VarChar(255)
  maleAge          Int?
  maleBirthPlace   String?      @db.VarChar(255) // ุฌุฏูุฏ
  maleRegistration String?      @db.VarChar(255) // ุฌุฏูุฏ
  maleCountry      String?      @db.VarChar(255) // ุฌุฏูุฏ
  
  // ุจูุงูุงุช ุงูุฒูุฌุฉ (ุฃุตุจุญุช ุงุฎุชูุงุฑูุฉ)
  femaleName       String?      @db.VarChar(255)
  femaleLastName   String?      @db.VarChar(255)
  femaleFatherName String?      @db.VarChar(255)
  femaleBirthDate  DateTime?    @db.DateTime
  femaleNationalId String?      @db.VarChar(255)
  femaleAge        Int?
  femaleBirthPlace String?      @db.VarChar(255) // ุฌุฏูุฏ
  femaleRegistration String?    @db.VarChar(255) // ุฌุฏูุฏ
  femaleCountry    String?      @db.VarChar(255) // ุฌุฏูุฏ
}
```

### 3. Migration
ุชู ุฅูุดุงุก migration ุจุชุงุฑูุฎ: `20251014160243_add_spouse_status_and_location_fields`

---

## ๐ป ุงูุชุบููุฑุงุช ูู Backend

### 1. Reception Service (`src/services/reception.service.ts`)

#### ุชุญุฏูุซ ุฏุงูุฉ createReceptionData
- ุฃุตุจุญุช ุชุฏุนู ุงูุญุงูุงุช ุงููุฎุชููุฉ
- ุชููู ุจุชุญุฏูุฏ ุงุณู ุงููุฑุงุฌุน ุจูุงุกู ุนูู ุงูุญุงูุฉ:
  - ุฅุฐุง ูุงู ุงูุฒูุฌ ูู ุญุงูุฉ NORMAL ุฃู LEGAL_INVITATION: ูุณุชุฎุฏู ุงุณู ุงูุฒูุฌ
  - ุฅุฐุง ูุงูุช ุงูุฒูุฌุฉ ูู ุญุงูุฉ LEGAL_INVITATION ููุท: ูุณุชุฎุฏู ุงุณู ุงูุฒูุฌุฉ
- ุชููู ุจุญูุธ ุฌููุน ุงูุญููู ุงูุฌุฏูุฏุฉ

#### ุชุญุฏูุซ ุฏุงูุฉ updateReceptionData
- ุฃุถููุช ุฏุนู ุชุญุฏูุซ ุงูุญููู ุงูุฌุฏูุฏุฉ (maleStatus, femaleStatus, birthPlace, registration, country)

### 2. Reception Controller (`src/controllers/reception.controller.ts`)

#### Validation Logic ุงูุฌุฏูุฏ
```javascript
// ุงูุชุญูู ูู ูุฌูุฏ ุงูุญุงูุฉ
if (!maleStatus || !femaleStatus) {
  return error("ุญุงูุฉ ุงูุฒูุฌ ูุงูุฒูุฌุฉ ูุทููุจุฉ");
}

// ุฅุฐุง ูุงูุช ุงูุญุงูุฉ NORMAL ููุทุฑููู
if (maleStatus === "NORMAL" && femaleStatus === "NORMAL") {
  // ุฌููุน ุจูุงูุงุช ุงูุฒูุฌูู ูุทููุจุฉ
}

// ุฅุฐุง ูุงูุช ุญุงูุฉ ุงูุฒูุฌ NORMAL ุฃู LEGAL_INVITATION
if (maleStatus === "NORMAL" || maleStatus === "LEGAL_INVITATION") {
  // ุจูุงูุงุช ุงูุฒูุฌ ูุทููุจุฉ
}

// ุฅุฐุง ูุงูุช ุญุงูุฉ ุงูุฒูุฌุฉ NORMAL ุฃู LEGAL_INVITATION
if (femaleStatus === "NORMAL" || femaleStatus === "LEGAL_INVITATION") {
  // ุจูุงูุงุช ุงูุฒูุฌุฉ ูุทููุจุฉ
}
```

---

## ๐จ ุงูุชุบููุฑุงุช ูู Frontend

### 1. ูุงุฌูุฉ ุงููุณุชุฎุฏู (`web/src/pages/ReceptionPage.tsx`)

#### ุฅุถุงูุฉ ููุงุฆู ููุณุฏูุฉ ููุญุงูุฉ
ููู ูู ุงูุฒูุฌ ูุงูุฒูุฌุฉ:
```jsx
<select name="maleStatus" value={formData.maleStatus}>
  <option value="NORMAL">ุนุงุฏู - ุงูุฒูุฌ ููุฌูุฏ</option>
  <option value="LEGAL_INVITATION">ุฏุนูุฉ ุดุฑุนูุฉ</option>
  <option value="OUT_OF_COUNTRY">ุฎุงุฑุฌ ุงููุทุฑ</option>
  <option value="OUT_OF_PROVINCE">ุฎุงุฑุฌ ุงููุญุงูุธุฉ</option>
</select>
```

#### ุฅุถุงูุฉ ุงูุญููู ุงูุฌุฏูุฏุฉ
- ููุงู ุงูููุงุฏุฉ
- ุงูููุฏ
- ุงูุจูุฏ

#### Dynamic Form Validation
ุงูุญููู ุชุตุจุญ:
- **ูุทููุจุฉ (required)**: ุนูุฏูุง ุชููู ุงูุญุงูุฉ NORMAL ุฃู LEGAL_INVITATION
- **ูุนุทูุฉ (disabled)**: ุนูุฏูุง ุชููู ุงูุญุงูุฉ OUT_OF_COUNTRY ุฃู OUT_OF_PROVINCE

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุณููุงุฑูู 1: ุญุงูุฉ ุนุงุฏูุฉ (ุงูุฒูุฌุงู ููุฌูุฏุงู)
1. ุงุฎุชุฑ "ุนุงุฏู - ุงูุฒูุฌ ููุฌูุฏ" ููุฒูุฌ
2. ุงุฎุชุฑ "ุนุงุฏู - ุงูุฒูุฌุฉ ููุฌูุฏุฉ" ููุฒูุฌุฉ
3. ุฃุฏุฎู ุฌููุน ุงูุจูุงูุงุช ูููุง ุงูุทุฑููู (ูุทููุจุฉ)
4. ูููู ุฅุถุงูุฉ ููุงู ุงูููุงุฏุฉุ ุงูููุฏุ ูุงูุจูุฏ (ุงุฎุชูุงุฑู)

### ุณููุงุฑูู 2: ุฏุนูุฉ ุดุฑุนูุฉ (ุดุฎุต ูุงุญุฏ ููุท)

#### ููุฒูุฌ ููุท:
1. ุงุฎุชุฑ "ุฏุนูุฉ ุดุฑุนูุฉ" ููุฒูุฌ
2. ุงุฎุชุฑ ุฃู ุญุงูุฉ ููุฒูุฌุฉ (ููุถู "ุฏุนูุฉ ุดุฑุนูุฉ" ุฃู "ุฎุงุฑุฌ ุงููุทุฑ/ุงููุญุงูุธุฉ")
3. ุฃุฏุฎู ุจูุงูุงุช ุงูุฒูุฌ (ูุทููุจุฉ)
4. ุจูุงูุงุช ุงูุฒูุฌุฉ ุงุฎุชูุงุฑูุฉ

#### ููุฒูุฌุฉ ููุท:
1. ุงุฎุชุฑ ุฃู ุญุงูุฉ ููุฒูุฌ (ููุถู "ุฎุงุฑุฌ ุงููุทุฑ/ุงููุญุงูุธุฉ")
2. ุงุฎุชุฑ "ุฏุนูุฉ ุดุฑุนูุฉ" ููุฒูุฌุฉ
3. ุจูุงูุงุช ุงูุฒูุฌ ุงุฎุชูุงุฑูุฉ
4. ุฃุฏุฎู ุจูุงูุงุช ุงูุฒูุฌุฉ (ูุทููุจุฉ)

### ุณููุงุฑูู 3: ุฃุญุฏ ุงูุทุฑููู ุฎุงุฑุฌ ุงููุทุฑ
1. ุงุฎุชุฑ "ุนุงุฏู" ุฃู "ุฏุนูุฉ ุดุฑุนูุฉ" ููุทุฑู ุงูููุฌูุฏ
2. ุงุฎุชุฑ "ุฎุงุฑุฌ ุงููุทุฑ" ููุทุฑู ุงูุบุงุฆุจ
3. ุฃุฏุฎู ุจูุงูุงุช ุงูุทุฑู ุงูููุฌูุฏ ููุท
4. ุญููู ุงูุทุฑู ุงูุบุงุฆุจ ุณุชููู ูุนุทูุฉ

### ุณููุงุฑูู 4: ุฃุญุฏ ุงูุทุฑููู ุฎุงุฑุฌ ุงููุญุงูุธุฉ
1. ุงุฎุชุฑ "ุนุงุฏู" ุฃู "ุฏุนูุฉ ุดุฑุนูุฉ" ููุทุฑู ุงูููุฌูุฏ
2. ุงุฎุชุฑ "ุฎุงุฑุฌ ุงููุญุงูุธุฉ" ููุทุฑู ุงูุบุงุฆุจ
3. ุฃุฏุฎู ุจูุงูุงุช ุงูุทุฑู ุงูููุฌูุฏ ููุท
4. ุญููู ุงูุทุฑู ุงูุบุงุฆุจ ุณุชููู ูุนุทูุฉ

---

## ๐ ูุซุงู ุนูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ

### ุญุงูุฉ ุนุงุฏูุฉ:
```json
{
  "maleStatus": "NORMAL",
  "femaleStatus": "NORMAL",
  "maleName": "ุฃุญูุฏ",
  "maleLastName": "ูุญูุฏ",
  "maleFatherName": "ุนูู",
  "maleBirthDate": "1990-01-01",
  "maleNationalId": "12345678901",
  "maleAge": 34,
  "maleBirthPlace": "ุฏูุดู",
  "maleRegistration": "ุฏูุดู ุงูุฃููู",
  "maleCountry": "ุณูุฑูุง",
  "femaleName": "ูุงุทูุฉ",
  "femaleLastName": "ุฃุญูุฏ",
  "femaleFatherName": "ูุญูุฏ",
  "femaleBirthDate": "1992-05-15",
  "femaleNationalId": "98765432109",
  "femaleAge": 32,
  "femaleBirthPlace": "ุญูุจ",
  "femaleRegistration": "ุญูุจ ุงูุซุงููุฉ",
  "femaleCountry": "ุณูุฑูุง",
  "phoneNumber": "0912345678",
  "notes": "ููุงุญุธุงุช"
}
```

### ุฏุนูุฉ ุดุฑุนูุฉ (ุฒูุฌ ููุท):
```json
{
  "maleStatus": "LEGAL_INVITATION",
  "femaleStatus": "OUT_OF_COUNTRY",
  "maleName": "ุฃุญูุฏ",
  "maleLastName": "ูุญูุฏ",
  "maleFatherName": "ุนูู",
  "maleBirthDate": "1990-01-01",
  "maleNationalId": "12345678901",
  "maleAge": 34,
  "maleBirthPlace": "ุฏูุดู",
  "maleRegistration": "ุฏูุดู ุงูุฃููู",
  "maleCountry": "ุณูุฑูุง",
  "phoneNumber": "0912345678"
}
```

---

## โ๏ธ ููุงุญุธุงุช ูุงูุฉ

1. **ุงูุญููู ุงูุฅูุฒุงููุฉ** ุชุนุชูุฏ ุนูู ุงูุญุงูุฉ ุงููุฎุชุงุฑุฉ
2. **ุงูุฑูู ุงููุทูู** ูู ูุนุฏ unique constraint ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฃุตุจุญ nullable)
3. **ุงุณู ุงููุฑุงุฌุน** ูุชู ุชุญุฏูุฏู ุชููุงุฆูุงู ุจูุงุกู ุนูู ุงูุญุงูุฉ
4. **ุฌููุน ุงูุญููู ุงูุฌุฏูุฏุฉ** (ููุงู ุงูููุงุฏุฉุ ุงูููุฏุ ุงูุจูุฏ) ุงุฎุชูุงุฑูุฉ
5. ุนูุฏ ุงุฎุชูุงุฑ "ุฎุงุฑุฌ ุงููุทุฑ" ุฃู "ุฎุงุฑุฌ ุงููุญุงูุธุฉ"ุ ุงูุญููู ุชุตุจุญ ูุนุทูุฉ ูู ุงููุงุฌูุฉ

---

## ๐ง ุฎุทูุงุช ูุง ุจุนุฏ ุงูุชุญุฏูุซ

1. **ุฅุนุงุฏุฉ ุชุดุบูู Backend**:
   ```bash
   npm run dev
   # ุฃู
   npx nodemon
   ```

2. **ุฅุนุงุฏุฉ ุชุดุบูู Frontend**:
   ```bash
   cd web
   npm run dev
   ```

3. **ุงูุชุญูู ูู Migration**:
   - ุชู ุชุทุจูู Migration ุชููุงุฆูุงู
   - ููุชุญูู: ุชููุฏ ุฌุฏูู `reception_data` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

4. **Prisma Client**:
   - ุณูุชู ุชูููุฏู ุชููุงุฆูุงู ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู Backend
   - ุฅุฐุง ูุงุฌูุช ูุดููุฉุ ุฃููู Backend ููู ุจุชุดุบูู:
     ```bash
     npx prisma generate
     ```

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

1. `prisma/schema.prisma` - ุชุญุฏูุซ Schema
2. `prisma/migrations/20251014160243_add_spouse_status_and_location_fields/migration.sql` - Migration
3. `src/services/reception.service.ts` - Business Logic
4. `src/controllers/reception.controller.ts` - API Endpoints & Validation
5. `web/src/pages/ReceptionPage.tsx` - UI Components

---

## ๐ฏ ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุขู ูุฏุนู:
โ 4 ุญุงูุงุช ูุฎุชููุฉ ููู ูู ุงูุฒูุฌูู
โ ุญููู ุฅุถุงููุฉ (ููุงู ุงูููุงุฏุฉุ ุงูููุฏุ ุงูุจูุฏ)
โ Validation ุฏููุงูููู ุญุณุจ ุงูุญุงูุฉ
โ ุญููู ุงุฎุชูุงุฑูุฉ ูุฅูุฒุงููุฉ ุญุณุจ ุงูุญุงูุฉ
โ ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุฏุซุฉ ูุน ุชุนุทูู ุงูุญููู ุบูุฑ ุงููุทููุจุฉ

ุชู ุฅูุฌุงุฒ ุฌููุน ุงูุชุญุฏูุซุงุช ุจูุฌุงุญ! โจ

