# ๐ฏ ุงูุงุณุชูุจุงู ูููุทุฉ ุงูุจุฏุงูุฉ

## ุงูุชุนุฏูู ุงูุฌุฏูุฏ

ุชู ุชุนุฏูู ุงููุธุงู ููุฌุนู **ูุญุทุฉ ุงูุงุณุชูุจุงู** ูู **ููุทุฉ ุงูุจุฏุงูุฉ** ูููุธุงู ุจุงููุงูู.

---

## โก ุงููุฑู ุงูุฃุณุงุณู

### ูุจู ุงูุชุนุฏูู
```
1. ุฅูุดุงุก ุฏูุฑ ูุฏููุงู (POST /api/queue/create)
2. ุงุณุชุฏุนุงุก ุงููุฑูุถ ูู ุงูุงุณุชูุจุงู
3. ุญูุธ ุจูุงูุงุช ุงูุงุณุชูุจุงู
4. ุงุณุชุฏุนุงุก ุงููุฑูุถ ุงูุชุงูู
```

### ุจุนุฏ ุงูุชุนุฏูู โ
```
1. ุฅุฏุฎุงู ุจูุงูุงุช ุงูุงุณุชูุจุงู ูุจุงุดุฑุฉ (POST /api/reception)
   โ
   โ ุฅูุดุงุก ูุฑูุถ ุฌุฏูุฏ ุชููุงุฆูุงู (ุจุงุณู ุงูุฐูุฑ ูุฑููู ุงููุทูู)
   โ
   โ ุฅูุดุงุก ุฏูุฑ ุฌุฏูุฏ ุชููุงุฆูุงู
   โ
   โ ุญูุธ ุจูุงูุงุช ุงูุงุณุชูุจุงู
   โ
   โ ุฅุธูุงุฑู ุนูู ุงูุดุงุดุฉ ูุจุงุดุฑุฉ
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ (ููุตู ุจูุง)

#### 1. ุฅุฏุฎุงู ุจูุงูุงุช ุงูุงุณุชูุจุงู ูุจุงุดุฑุฉ
```bash
POST http://localhost:3001/api/reception
Content-Type: application/json

{
  "maleName": "ุฃุญูุฏ",
  "maleLastName": "ูุญูุฏ",
  "maleFatherName": "ุนูู",
  "maleBirthDate": "1995-01-15",
  "maleNationalId": "1234567890",
  "maleAge": 29,
  "femaleName": "ูุงุทูุฉ",
  "femaleLastName": "ุญุณู",
  "femaleFatherName": "ุฎุงูุฏ",
  "femaleBirthDate": "1997-03-20",
  "femaleNationalId": "0987654321",
  "femaleAge": 27,
  "phoneNumber": "0501234567",  // ุงุฎุชูุงุฑู
  "notes": "ููุงุญุธุงุช",           // ุงุฎุชูุงุฑู
  "priority": 0                  // ุงุฎุชูุงุฑู
}
```

#### 2. ุงููุชูุฌุฉ
```json
{
  "success": true,
  "message": "ุชู ุฅูุดุงุก ุงููุฑูุถ ูุงูุฏูุฑ ูุญูุธ ุจูุงูุงุช ุงูุงุณุชูุจุงู ุจูุฌุงุญ",
  "patient": {
    "id": 1,
    "name": "ุฃุญูุฏ ูุญูุฏ",
    "nationalId": "1234567890",
    "phoneNumber": "0501234567"
  },
  "queue": {
    "id": 1,
    "queueNumber": 1,
    "patientId": 1,
    "currentStationId": 1,
    "status": "ACTIVE"
  },
  "queueNumber": 1,
  "receptionData": {
    "id": 1,
    "queueId": 1,
    "patientId": 1,
    "maleName": "ุฃุญูุฏ",
    ...
  }
}
```

---

## ๐ ุณูุฑ ุงูุนูู ุงููุงูู

### ุงููุฑูุถ ุงูุฃูู
```
1. ููุธู ุงูุงุณุชูุจุงู ูุฏุฎู ุงูุจูุงูุงุช
   POST /api/reception
   โ
2. ุงููุธุงู ูููุดุฆ:
   โ ูุฑูุถ ุฌุฏูุฏ (ุฃุญูุฏ ูุญูุฏ - 1234567890)
   โ ุฏูุฑ ุฌุฏูุฏ (#1)
   โ ุจูุงูุงุช ุงูุงุณุชูุจุงู
   โ
3. ูุธูุฑ ุนูู ุงูุดุงุดุฉ: "ุงูุฏูุฑ #1 โ ุงูุดุงุดุฉ 1"
   โ
4. ุงููุฑูุถ ููุชูู ูููุฎุชุจุฑ
   POST /api/lab (ูุน ุงุณุชุฏุนุงุก ุงูุชุงูู)
   โ
5. ุงููุฑูุถ ููุชูู ููุทุจูุจ
   POST /api/doctor (ูุน ุงุณุชุฏุนุงุก ุงูุชุงูู)
```

### ุงููุฑูุถ ุงูุซุงูู
```
1. ููุธู ุงูุงุณุชูุจุงู ูุฏุฎู ุจูุงูุงุช ุงููุฑูุถ ุงูุซุงูู
   POST /api/reception
   โ
2. ูููุดุฃ ุฏูุฑ #2 ุชููุงุฆูุงู
   โ
3. ูููุฐุง...
```

---

## โจ ุงูููุฒุงุช

### 1. ุฅูุดุงุก ุชููุงุฆู ูููุฑูุถ
- ูุชู ุฅูุดุงุก ุงููุฑูุถ ุจุงุณู ุงูุฐูุฑ ูุฑููู ุงููุทูู
- ูุง ุญุงุฌุฉ ูุฅูุดุงุก ุงููุฑูุถ ูุฏููุงู

### 2. ุฅูุดุงุก ุชููุงุฆู ููุฏูุฑ
- ูุชู ูุทุน ุฏูุฑ ุฌุฏูุฏ ุชููุงุฆูุงู
- ุฑูู ุงูุฏูุฑ ูุฒูุฏ ุชููุงุฆูุงู (1, 2, 3, ...)

### 3. ุธููุฑ ูุจุงุดุฑ ุนูู ุงูุดุงุดุฉ
- ูุธูุฑ ุงูุฏูุฑ ุงูุฌุฏูุฏ ุนูู ุงูุดุงุดุฉ ูุจุงุดุฑุฉ
- ุญุงูุฉ CALLED (ุชู ุงูุงุณุชุฏุนุงุก)

### 4. ุจูุงูุงุช ุดุงููุฉ
- ุญูุธ ุจูุงูุงุช ูุงููุฉ ููุฒูุฌูู
- ุฑูู ุงููุงุชู (ุงุฎุชูุงุฑู)
- ุงูููุงุญุธุงุช (ุงุฎุชูุงุฑูุฉ)
- ุงูุฃููููุฉ (ุงุฎุชูุงุฑูุฉ)

---

## ๐ ุงูุญููู ุงููุทููุจุฉ

### ุญููู ุฅูุฒุงููุฉ โ
```typescript
{
  maleName: string;           // ุงุณู ุงูุฐูุฑ
  maleLastName: string;       // ุงุณู ุงูุนุงุฆูุฉ ููุฐูุฑ
  maleFatherName: string;     // ุงุณู ุงูุฃุจ ููุฐูุฑ
  maleBirthDate: Date;        // ุชุงุฑูุฎ ูููุงุฏ ุงูุฐูุฑ
  maleNationalId: string;     // ุงูุฑูู ุงููุทูู ููุฐูุฑ
  maleAge: number;            // ุนูุฑ ุงูุฐูุฑ
  
  femaleName: string;         // ุงุณู ุงูุฃูุซู
  femaleLastName: string;     // ุงุณู ุงูุนุงุฆูุฉ ููุฃูุซู
  femaleFatherName: string;   // ุงุณู ุงูุฃุจ ููุฃูุซู
  femaleBirthDate: Date;      // ุชุงุฑูุฎ ูููุงุฏ ุงูุฃูุซู
  femaleNationalId: string;   // ุงูุฑูู ุงููุทูู ููุฃูุซู
  femaleAge: number;          // ุนูุฑ ุงูุฃูุซู
}
```

### ุญููู ุงุฎุชูุงุฑูุฉ
```typescript
{
  phoneNumber?: string;       // ุฑูู ุงููุงุชู
  notes?: string;             // ููุงุญุธุงุช
  priority?: number;          // ุงูุฃููููุฉ (0 = ุนุงุฏู)
}
```

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ

### ูุง ูุญุฏุซ ุฏุงุฎููุงู

```typescript
// 1. ุฅูุดุงุก ุงููุฑูุถ
const patient = await prisma.patient.create({
  name: `${maleName} ${maleLastName}`,
  nationalId: maleNationalId,
  phoneNumber: phoneNumber // ุงุฎุชูุงุฑู
});

// 2. ูุทุน ุฏูุฑ ุฌุฏูุฏ
const queueNumber = lastNumber + 1;

const queue = await prisma.queue.create({
  queueNumber: queueNumber,
  patientId: patient.id,
  currentStationId: firstStation.id,
  status: "ACTIVE"
});

// 3. ุฅูุดุงุก ุณุฌู ูู QueueHistory (ุญุงูุฉ CALLED)
await prisma.queueHistory.create({
  queueId: queue.id,
  stationId: firstStation.id,
  status: "CALLED",
  calledAt: new Date()
});

// 4. ุญูุธ ุจูุงูุงุช ุงูุงุณุชูุจุงู
const receptionData = await prisma.receptionData.create({
  queueId: queue.id,
  patientId: patient.id,
  maleName, maleLastName, ...
});

// 5. ุฅุฑุณุงู ููุดุงุดุงุช
emitPatientCalled({
  queueNumber,
  displayNumber,
  stationId,
  calledAt
});
```

---

## ๐ฏ ูุซุงู ุนููู ูุงูู

### ุงูุฎุทูุฉ 1: ุฅุฏุฎุงู ุจูุงูุงุช ุงูุงุณุชูุจุงู ูููุฑูุถ ุงูุฃูู
```bash
curl -X POST http://localhost:3001/api/reception \
  -H "Content-Type: application/json" \
  -d '{
    "maleName": "ุฃุญูุฏ",
    "maleLastName": "ูุญูุฏ",
    "maleFatherName": "ุนูู",
    "maleBirthDate": "1995-01-15",
    "maleNationalId": "1234567890",
    "maleAge": 29,
    "femaleName": "ูุงุทูุฉ",
    "femaleLastName": "ุญุณู",
    "femaleFatherName": "ุฎุงูุฏ",
    "femaleBirthDate": "1997-03-20",
    "femaleNationalId": "0987654321",
    "femaleAge": 27,
    "phoneNumber": "0501234567"
  }'
```

**ุงููุชูุฌุฉ:**
- โ ุชู ุฅูุดุงุก ุงููุฑูุถ: ุฃุญูุฏ ูุญูุฏ (1234567890)
- โ ุชู ุฅูุดุงุก ุงูุฏูุฑ #1
- โ ุธูุฑ ุนูู ุงูุดุงุดุฉ ูุจุงุดุฑุฉ

### ุงูุฎุทูุฉ 2: ุงูุงูุชูุงู ูููุฎุชุจุฑ
```bash
# ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุงุณุชูุจุงู
POST http://localhost:3001/api/stations/1/complete-service
{
  "queueId": 1
}

# ูู ุงููุฎุชุจุฑ: ุงุณุชุฏุนุงุก ุงููุฑูุถ
POST http://localhost:3001/api/stations/2/call-next

# ุญูุธ ุจูุงูุงุช ุงููุฎุชุจุฑ (ูุณุชุฏุนู ุงูุชุงูู ุชููุงุฆูุงู)
POST http://localhost:3001/api/lab
{
  "queueId": 1,
  "patientId": 1,
  "isMaleHealthy": "HEALTHY",
  "isFemaleHealthy": "HEALTHY"
}
```

### ุงูุฎุทูุฉ 3: ุงูุงูุชูุงู ููุทุจูุจ
```bash
# ุงูุงูุชูุงู ููุทุจูุจ
POST http://localhost:3001/api/stations/2/complete-service
{
  "queueId": 1
}

# ุนูุฏ ุงูุทุจูุจ: ุงุณุชุฏุนุงุก
POST http://localhost:3001/api/stations/3/call-next

# ุญูุธ ุจูุงูุงุช ุงูุทุจูุจ (ูุณุชุฏุนู ุงูุชุงูู ุชููุงุฆูุงู)
POST http://localhost:3001/api/doctor
{
  "queueId": 1,
  "patientId": 1,
  "maleBloodType": "O+",
  "femaleBloodType": "A+",
  "maleHIVstatus": "NEGATIVE",
  "femaleHIVstatus": "NEGATIVE",
  "maleHBSstatus": "NEGATIVE",
  "femaleHBSstatus": "NEGATIVE",
  "maleHBCstatus": "NEGATIVE",
  "femaleHBCstatus": "NEGATIVE"
}
```

### ุงูุฎุทูุฉ 4: ุฅุฏุฎุงู ุงููุฑูุถ ุงูุซุงูู (ูู ุงูุงุณุชูุจุงู)
```bash
POST http://localhost:3001/api/reception
{
  "maleName": "ุฎุงูุฏ",
  "maleLastName": "ุฃุญูุฏ",
  ...
}
```

**ุงููุชูุฌุฉ:**
- โ ุชู ุฅูุดุงุก ุฏูุฑ #2 ุชููุงุฆูุงู
- โ ุธูุฑ ุนูู ุงูุดุงุดุฉ

---

## ๐ ุงููุฑู ุจูู ุงูุทุฑููุชูู

### ุงูุทุฑููุฉ ุงููุฏููุฉ (ูุง ุชุฒุงู ูุชุงุญุฉ)
```bash
# 1. ุฅูุดุงุก ุฏูุฑ ูุฏููุงู
POST /api/queue/create
{
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "phoneNumber": "0501234567",
  "nationalId": "1234567890"
}

# 2. ุงุณุชุฏุนุงุก ูู ุงูุงุณุชูุจุงู
POST /api/stations/1/call-next

# 3. ุญูุธ ุจูุงูุงุช ุงูุงุณุชูุจุงู
POST /api/reception
{
  "queueId": 1,
  "patientId": 1,
  "maleName": "ุฃุญูุฏ",
  ...
}
```

### ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ โ (ููุตู ุจูุง)
```bash
# ุฎุทูุฉ ูุงุญุฏุฉ ููุท!
POST /api/reception
{
  "maleName": "ุฃุญูุฏ",
  "maleLastName": "ูุญูุฏ",
  ...
}
```

---

## โ ุงูููุงุฆุฏ

1. **ุณูููุฉ ุงูุงุณุชุฎุฏุงู**
   - ุฎุทูุฉ ูุงุญุฏุฉ ุจุฏูุงู ูู ุซูุงุซ ุฎุทูุงุช

2. **ุชูููู ุงูุฃุฎุทุงุก**
   - ูุง ุญุงุฌุฉ ูุชุชุจุน queueId ู patientId

3. **ุณุฑุนุฉ ุฃูุจุฑ**
   - ุฅูุดุงุก ุชููุงุฆู ูููุฑูุถ ูุงูุฏูุฑ

4. **ุชุฌุฑุจุฉ ุฃูุถู**
   - ููุธู ุงูุงุณุชูุจุงู ูุฏุฎู ุงูุจูุงูุงุช ูุฑุฉ ูุงุญุฏุฉ ููุท

---

## ๐ ููุงุญุธุงุช ูููุฉ

โ๏ธ **ุงูุงุณุชูุจุงู ุงูุขู ูู ููุทุฉ ุงูุจุฏุงูุฉ:**
- ูุง ุญุงุฌุฉ ูู `POST /api/queue/create` ุนูุฏ ุงุณุชุฎุฏุงู ุงูุงุณุชูุจุงู
- ุงููุฑูุถ ูููุดุฃ ุชููุงุฆูุงู ูู ุจูุงูุงุช ุงูุฐูุฑ
- ุงูุฏูุฑ ูููุดุฃ ุชููุงุฆูุงู ููุธูุฑ ุนูู ุงูุดุงุดุฉ

โ๏ธ **ูู ุงููุญุทุงุช ุงูุฃุฎุฑู (Lab & Doctor):**
- ูุชู ุงุณุชุฏุนุงุก ุงููุฑูุถ ุงูุชุงูู ุชููุงุฆูุงู ุจุนุฏ ุญูุธ ุงูุจูุงูุงุช
- ููุง ูู ูุทููุจ ูู ุงูุชุนุฏูู ุงูุณุงุจู

---

## ๐ ุงูุฎูุงุตุฉ

โ **ุงูุงุณุชูุจุงู = ููุทุฉ ุงูุจุฏุงูุฉ**
- ุฅุฏุฎุงู ุจูุงูุงุช โ ุฅูุดุงุก ูุฑูุถ ูุฏูุฑ ุฌุฏูุฏ ุชููุงุฆูุงู

โ **ุงููุฎุชุจุฑ ูุงูุทุจูุจ = ุงุณุชุฏุนุงุก ุชููุงุฆู**
- ุญูุธ ุจูุงูุงุช โ ุงุณุชุฏุนุงุก ุงููุฑูุถ ุงูุชุงูู ุชููุงุฆูุงู

โ **ูุธุงู ูุชูุงูู ูุณูุณ**
- ูู ุงูุงุณุชูุจุงู ุญุชู ุฅููุงุก ุงููุญุต ุงูุทุจู

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2025-10-12  
**ุงูุฅุตุฏุงุฑ:** 2.1.0

