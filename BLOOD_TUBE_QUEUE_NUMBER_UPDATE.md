# تحديث نظام أرقام أنابيب الدم

## التغييرات المنفذة

تم تحديث نظام توليد أرقام أنابيب الدم ليستخدم **رقم الدور (Queue Number)** بدلاً من `queueId`.

### قبل التحديث
كانت أرقام الأنابيب تُولد باستخدام `queueId` (المعرف الداخلي للدور):
```
الزوج - أنبوبة 1: 1523
الزوج - أنبوبة 2: 1523
الزوجة - أنبوبة 1: 1523
الزوجة - أنبوبة 2: 1523
```

### بعد التحديث
أصبحت أرقام الأنابيب تُولد باستخدام `queueNumber` (رقم الدور الظاهر للمستخدم):
```
الزوج - أنبوبة 1: 245
الزوج - أنبوبة 2: 245
الزوجة - أنبوبة 1: 245
الزوجة - أنبوبة 2: 245
```

## الفوائد

✅ **سهولة التتبع**: رقم الدور الظاهر للمستخدم أسهل في التذكر والتتبع  
✅ **توافق مع النظام**: يتطابق مع رقم الدور المعروض في جميع أنحاء النظام  
✅ **تجربة مستخدم أفضل**: أرقام أقصر وأكثر وضوحاً  

## الملفات المُعدلة

- `src/services/bloodDraw.service.ts` - تحديث دالة `generateBloodTubeNumbers()`

## كيفية الاستخدام

عند استدعاء مراجع في صفحة سحب الدم:

1. سيتم توليد أرقام الأنابيب تلقائياً باستخدام رقم الدور
2. عند حفظ البيانات، سيتم طباعة الملصقات بالأرقام الصحيحة
3. في الأرشيف، ستظهر الأرقام المرتبطة برقم الدور

## مثال عملي

إذا كان المراجع لديه رقم دور **#123**:

### أرقام أنابيب الزوج:
- `M123` (أنبوبة 1)
- `M123` (أنبوبة 2)

### أرقام أنابيب الزوجة:
- `F123` (أنبوبة 1)
- `F123` (أنبوبة 2)

حيث:
- `M` = Male (ذكر)
- `F` = Female (أنثى)
- `123` = رقم الدور

## ملاحظات هامة

⚠️ **قاعدة البيانات**: أرقام الأنابيب فريدة (UNIQUE) في قاعدة البيانات  
⚠️ **الطباعة**: يتم إضافة البادئة `M` أو `F` تلقائياً عند الطباعة  
⚠️ **الحالات الخاصة**: إذا كان الزوج أو الزوجة غير موجود، لن يتم توليد أرقام لهم  

## تاريخ التحديث

**التاريخ**: 2025-10-20  
**النسخة**: 1.0.1  
**المطور**: Sohaib Shaar

